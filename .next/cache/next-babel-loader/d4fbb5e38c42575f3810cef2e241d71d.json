{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { Fragment, useState } from \"react\";\nimport Head from \"next/head\";\nimport Nav from \"../../components/nav\";\nimport Footer from \"../../components/footer\";\nimport Image from \"next/image\";\nimport CounterInput from \"../../components/counterInput\";\nimport { getProductDetail } from \"../../api\";\nimport { PRODUCT_IMAGE_FILLER } from \"../../utils/consts\";\nimport { useCartActions } from \"../../contexts/CartContext\";\nimport { faShoppingBag } from \"@fortawesome/free-solid-svg-icons/faShoppingBag\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { getServerSideCookie } from \"../../utils/serverSideStorage\";\nimport { SideBySideMagnifier } from \"react-image-magnifiers\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nconst ProductDetail = ({\n  product\n}) => {\n  const {\n    _id,\n    name,\n    price,\n    category,\n    images = [],\n    description\n  } = product;\n  const {\n    findItem,\n    addItem\n  } = useCartActions();\n  const {\n    0: quantity,\n    1: setQuantity\n  } = useState(1);\n  const {\n    0: selectedImageIndex,\n    1: setSelectedImageIndex\n  } = useState(0);\n  const disableButton = Boolean(findItem(_id));\n\n  const onAddToCart = () => {\n    addItem(_objectSpread(_objectSpread({}, product), {}, {\n      quantity,\n      total_amount: price * quantity\n    }));\n  };\n\n  return /*#__PURE__*/_jsxs(Fragment, {\n    children: [/*#__PURE__*/_jsxs(Head, {\n      children: [/*#__PURE__*/_jsx(\"title\", {\n        children: \"Product detail\"\n      }), /*#__PURE__*/_jsx(\"link\", {\n        rel: \"icon\",\n        href: \"/favicon.ico\"\n      })]\n    }), /*#__PURE__*/_jsx(Nav, {}), /*#__PURE__*/_jsx(\"section\", {\n      className: \"container\",\n      children: /*#__PURE__*/_jsx(\"div\", {\n        className: \"app-page-container\",\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \"product-container\",\n          children: [/*#__PURE__*/_jsxs(\"div\", {\n            className: \"product-images-container\",\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              className: \"image-slider\",\n              children: images.map((item, index) => {\n                return /*#__PURE__*/_jsx(\"div\", {\n                  className: \"product-image\",\n                  onClick: () => {\n                    setSelectedImageIndex(index);\n                  },\n                  children: /*#__PURE__*/_jsx(\"img\", {\n                    src: (item === null || item === void 0 ? void 0 : item.url) || PRODUCT_IMAGE_FILLER,\n                    alt: (item === null || item === void 0 ? void 0 : item.originalFileName) || \"product image\"\n                  })\n                }, index);\n              })\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"main-image\",\n              children: images.map((item, index) => {\n                if (index !== selectedImageIndex) {\n                  return null;\n                }\n\n                return /*#__PURE__*/_jsx(SideBySideMagnifier, {\n                  imageSrc: (item === null || item === void 0 ? void 0 : item.url) || PRODUCT_IMAGE_FILLER,\n                  imageAlt: (item === null || item === void 0 ? void 0 : item.originalFileName) || \"product image\",\n                  largeImageSrc: (item === null || item === void 0 ? void 0 : item.url) || PRODUCT_IMAGE_FILLER,\n                  largeImageAlt: (item === null || item === void 0 ? void 0 : item.originalFileName) || \"product image\",\n                  fillAvailableSpace: false,\n                  zoomContainerBorder: \"1px solid #000000\",\n                  zoomContainerBoxShadow: \"0 3px 6px #00000029\"\n                }, index);\n              })\n            })]\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"product-details\",\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              className: \"mb-1\",\n              children: /*#__PURE__*/_jsx(\"div\", {\n                className: \"badge\",\n                children: category === null || category === void 0 ? void 0 : category.name\n              })\n            }), /*#__PURE__*/_jsx(\"h4\", {\n              className: \"product-title\",\n              children: name\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: \"product-price\",\n              children: [/*#__PURE__*/_jsx(\"span\", {\n                className: \"label\",\n                children: \"Price\"\n              }), /*#__PURE__*/_jsxs(\"h3\", {\n                children: [\"$\", price]\n              })]\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: \"action-container\",\n              children: [/*#__PURE__*/_jsx(CounterInput, {\n                value: quantity,\n                onChange: value => setQuantity(value)\n              }), /*#__PURE__*/_jsxs(\"button\", {\n                className: \"btn accent-btn\",\n                disabled: disableButton,\n                onClick: onAddToCart,\n                children: [/*#__PURE__*/_jsx(FontAwesomeIcon, {\n                  icon: faShoppingBag,\n                  size: \"2x\"\n                }), \"Add to Cart\"]\n              })]\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: \"product-description\",\n              children: [/*#__PURE__*/_jsx(\"span\", {\n                className: \"label\",\n                children: \"Description\"\n              }), /*#__PURE__*/_jsx(\"p\", {\n                children: description\n              })]\n            })]\n          })]\n        })\n      })\n    }), /*#__PURE__*/_jsx(Footer, {})]\n  });\n};\n\nexport default ProductDetail;\nexport const getServerSideProps = async ctx => {\n  const token = getServerSideCookie(ctx)(\"token\");\n\n  try {\n    const product = await getProductDetail(token)(ctx.params.id);\n    return {\n      props: {\n        product\n      }\n    };\n  } catch (e) {\n    ctx.res.writeHead(302, {\n      Location: \"/products\"\n    });\n    ctx.res.end();\n  }\n\n  return {\n    props: {}\n  };\n};","map":null,"metadata":{},"sourceType":"module"}