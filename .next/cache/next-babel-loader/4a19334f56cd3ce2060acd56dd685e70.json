{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport React, { Fragment, useEffect, useState } from \"react\";\nimport Head from \"next/head\";\nimport Nav from \"../../components/nav\";\nimport Footer from \"../../components/footer\";\nimport Product from \"../../components/product\";\nimport IconSearch from \"../../components/icons/icon-search\";\nimport IconChevronDown from \"../../components/icons/icon-chevron-down\";\nimport MiniSearch from \"minisearch\";\nimport { PRICE_FILTER_RANGES } from \"../../utils/consts\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nvar Products = function Products(_ref) {\n  var categories = _ref.categories,\n      products = _ref.products;\n\n  var _useState = useState(\"\"),\n      searchText = _useState[0],\n      setSearchText = _useState[1];\n\n  var _useState2 = useState(),\n      searchProducts = _useState2[0],\n      setSearchProducts = _useState2[1];\n\n  var _useState3 = useState([]),\n      selectedCategories = _useState3[0],\n      setSelectedCategories = _useState3[1];\n\n  var _useState4 = useState([]),\n      priceRanges = _useState4[0],\n      setPriceRanges = _useState4[1];\n\n  var _useState5 = useState({\n    categories: [],\n    priceRanges: []\n  }),\n      filters = _useState5[0],\n      setFilters = _useState5[1];\n\n  var _useState6 = useState(),\n      sortBy = _useState6[0],\n      setSortBy = _useState6[1];\n\n  var searchedProducts = searchProducts || products;\n  var categoryFilteredProducts = filters.categories.length > 0 ? searchedProducts.filter(function (item) {\n    return filters.categories.find(function (categoryId) {\n      var _item$category;\n\n      return categoryId === (item === null || item === void 0 ? void 0 : (_item$category = item.category) === null || _item$category === void 0 ? void 0 : _item$category._id);\n    });\n  }) : searchedProducts;\n  var priceRangeFilteredProducts = filters.priceRanges.length > 0 ? categoryFilteredProducts.filter(function (item) {\n    return filters.priceRanges.filter(function (index) {\n      return PRICE_FILTER_RANGES[index].min <= item.price && PRICE_FILTER_RANGES[index].max >= item.price;\n    }).length > 0;\n  }) : categoryFilteredProducts;\n  var sortedProducts = sortBy ? priceRangeFilteredProducts.sort(function (a, b) {\n    if (sortBy === \"top-rated\") {\n      return true;\n    }\n\n    if (sortBy === \"high-low\") {\n      return b.price - a.price;\n    }\n\n    if (sortBy === \"low-high\") {\n      return a.price - b.price;\n    }\n\n    return true;\n  }) : priceRangeFilteredProducts;\n\n  var onCategoryChange = function onCategoryChange(checked, id) {\n    if (checked) {\n      setSelectedCategories(function (prev) {\n        return [].concat(_toConsumableArray(prev), [id]);\n      });\n    } else {\n      setSelectedCategories(selectedCategories.filter(function (item) {\n        return item !== id;\n      }));\n    }\n  };\n\n  var onPriceRangeChange = function onPriceRangeChange(checked, index) {\n    if (checked) {\n      setPriceRanges(function (prev) {\n        return [].concat(_toConsumableArray(prev), [index]);\n      });\n    } else {\n      setPriceRanges(priceRanges.filter(function (item) {\n        return item !== index;\n      }));\n    }\n  };\n\n  var onApplyClick = function onApplyClick() {\n    setFilters({\n      categories: selectedCategories,\n      priceRanges: priceRanges\n    });\n  };\n\n  var onResetClick = function onResetClick() {\n    setFilters({\n      categories: [],\n      priceRanges: []\n    });\n    setSelectedCategories([]);\n    setPriceRanges([]);\n  };\n\n  useEffect(function () {\n    if (searchText === \"\") {\n      setSearchProducts(null);\n      return;\n    }\n\n    var miniSearch = new MiniSearch({\n      fields: [\"name\", \"price\"],\n      idField: \"_id\"\n    });\n    miniSearch.addAll(products);\n    var searchResults = miniSearch.search(searchText, {\n      fuzzy: 0.2,\n      prefix: true\n    });\n    setSearchProducts(products.filter(function (product) {\n      return searchResults.find(function (searchItem) {\n        return product._id === searchItem.id;\n      });\n    }));\n  }, [searchText]);\n  return /*#__PURE__*/_jsxs(Fragment, {\n    children: [/*#__PURE__*/_jsxs(Head, {\n      children: [/*#__PURE__*/_jsx(\"title\", {\n        children: \"Products\"\n      }), /*#__PURE__*/_jsx(\"link\", {\n        rel: \"icon\",\n        href: \"/favicon.ico\"\n      }), /*#__PURE__*/_jsx(\"meta\", {\n        property: \"og:title\",\n        content: \"Best-priced handicraft products from Nepal | Yala Treasure\"\n      }, \"product_title\"), /*#__PURE__*/_jsx(\"meta\", {\n        property: \"og:description\",\n        content: \"Yala Treasure - an online shopping platform for Nepali arts and crafts. Buy all kinds of unique, local, and best-priced handicraft products made in Nepal now!\"\n      }, \"product_description\")]\n    }), /*#__PURE__*/_jsx(Nav, {}), /*#__PURE__*/_jsx(\"section\", {\n      className: \"container\",\n      children: /*#__PURE__*/_jsx(\"div\", {\n        className: \"app-page-container\",\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: \"product-grid-container\",\n          children: [/*#__PURE__*/_jsxs(\"div\", {\n            className: \"product-filter-container\",\n            children: [/*#__PURE__*/_jsx(\"h3\", {\n              className: \"filter-title\",\n              children: \"Filters\"\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: \"filter-block-list\",\n              children: [/*#__PURE__*/_jsxs(\"div\", {\n                className: \"accordion-block\",\n                children: [/*#__PURE__*/_jsxs(\"div\", {\n                  className: \"accordion-heading\",\n                  children: [/*#__PURE__*/_jsx(\"span\", {\n                    children: \"Type\"\n                  }), /*#__PURE__*/_jsx(IconChevronDown, {})]\n                }), /*#__PURE__*/_jsx(\"div\", {\n                  className: \"accordion-content\",\n                  children: categories.map(function (item) {\n                    return /*#__PURE__*/_jsx(\"div\", {\n                      className: \"list-item\",\n                      children: /*#__PURE__*/_jsxs(\"label\", {\n                        className: \"checkbox-wrapper\",\n                        children: [/*#__PURE__*/_jsx(\"input\", {\n                          type: \"checkbox\",\n                          className: \"form-control\",\n                          checked: selectedCategories.includes(item._id),\n                          onChange: function onChange(e) {\n                            onCategoryChange(e.target.checked, item._id);\n                          }\n                        }), item.name]\n                      })\n                    }, item._id);\n                  })\n                })]\n              }), /*#__PURE__*/_jsxs(\"div\", {\n                className: \"accordion-block\",\n                children: [/*#__PURE__*/_jsxs(\"div\", {\n                  className: \"accordion-heading\",\n                  children: [/*#__PURE__*/_jsx(\"span\", {\n                    children: \"Price Range\"\n                  }), /*#__PURE__*/_jsx(IconChevronDown, {})]\n                }), /*#__PURE__*/_jsx(\"div\", {\n                  className: \"accordion-content\",\n                  children: PRICE_FILTER_RANGES.map(function (item, index) {\n                    return /*#__PURE__*/_jsx(\"div\", {\n                      className: \"list-item\",\n                      children: /*#__PURE__*/_jsxs(\"label\", {\n                        className: \"checkbox-wrapper\",\n                        children: [/*#__PURE__*/_jsx(\"input\", {\n                          type: \"checkbox\",\n                          className: \"form-control\",\n                          checked: priceRanges.includes(index),\n                          onChange: function onChange(e) {\n                            onPriceRangeChange(e.target.checked, index);\n                          }\n                        }), item.label]\n                      })\n                    }, index);\n                  })\n                })]\n              })]\n            }), /*#__PURE__*/_jsxs(\"div\", {\n              className: \"filter-actions\",\n              children: [/*#__PURE__*/_jsx(\"button\", {\n                className: \"btn primary-outline-btn\",\n                onClick: onResetClick,\n                children: \"Reset\"\n              }), /*#__PURE__*/_jsx(\"button\", {\n                className: \"btn accent-btn\",\n                onClick: onApplyClick,\n                children: \"Apply\"\n              })]\n            })]\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: \"product-list-container\",\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              className: \"product-list-heading\",\n              children: [/*#__PURE__*/_jsxs(\"div\", {\n                className: \"search-container\",\n                children: [/*#__PURE__*/_jsx(IconSearch, {}), /*#__PURE__*/_jsx(\"input\", {\n                  type: \"search\",\n                  className: \"form-control\",\n                  placeholder: \"Search\",\n                  value: searchText,\n                  onChange: function onChange(e) {\n                    setSearchText(e.target.value);\n                  }\n                })]\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"filter-toggle\",\n                children: /*#__PURE__*/_jsx(\"button\", {\n                  className: \"btn primary-outline-btn\",\n                  children: \"Filter\"\n                })\n              }), /*#__PURE__*/_jsx(\"div\", {\n                className: \"select-container\",\n                children: /*#__PURE__*/_jsxs(\"select\", {\n                  className: \"form-control\",\n                  value: sortBy,\n                  onChange: function onChange(e) {\n                    return setSortBy(e.target.value);\n                  },\n                  children: [/*#__PURE__*/_jsx(\"option\", {\n                    children: \"Sort By\"\n                  }), /*#__PURE__*/_jsx(\"option\", {\n                    value: \"top-rated\",\n                    children: \"Top Rated\"\n                  }), /*#__PURE__*/_jsx(\"option\", {\n                    value: \"high-low\",\n                    children: \"Price: High to Low\"\n                  }), /*#__PURE__*/_jsx(\"option\", {\n                    value: \"low-high\",\n                    children: \"Price: Low to High\"\n                  })]\n                })\n              })]\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"product-block\",\n              children: sortedProducts.map(function (item, index) {\n                return /*#__PURE__*/_jsx(Product, {\n                  data: item\n                }, index);\n              })\n            })]\n          })]\n        })\n      })\n    }), /*#__PURE__*/_jsx(Footer, {})]\n  });\n};\n\nexport var __N_SSP = true;\nexport default Products;","map":null,"metadata":{},"sourceType":"module"}