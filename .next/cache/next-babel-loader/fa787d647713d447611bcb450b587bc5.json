{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\n\nvar _jsxFileName = \"/home/anuz/work/personal/creation-arts/pages/products/index.js\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { Fragment, useEffect, useState } from \"react\";\nimport Head from \"next/head\";\nimport Nav from \"../../components/nav\";\nimport Footer from \"../../components/footer\";\nimport Product from \"../../components/product\";\nimport IconSearch from \"../../components/icons/icon-search\";\nimport IconChevronDown from \"../../components/icons/icon-chevron-down\";\nimport MiniSearch from \"minisearch\";\nimport { PRICE_FILTER_RANGES } from \"../../utils/consts\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar Products = function Products(_ref) {\n  _s();\n\n  var categories = _ref.categories,\n      products = _ref.products;\n\n  var _useState = useState(\"\"),\n      searchText = _useState[0],\n      setSearchText = _useState[1];\n\n  var _useState2 = useState(),\n      searchProducts = _useState2[0],\n      setSearchProducts = _useState2[1];\n\n  var _useState3 = useState([]),\n      selectedCategories = _useState3[0],\n      setSelectedCategories = _useState3[1];\n\n  var _useState4 = useState([]),\n      priceRanges = _useState4[0],\n      setPriceRanges = _useState4[1];\n\n  var _useState5 = useState({\n    categories: [],\n    priceRanges: []\n  }),\n      filters = _useState5[0],\n      setFilters = _useState5[1];\n\n  var _useState6 = useState(),\n      sortBy = _useState6[0],\n      setSortBy = _useState6[1];\n\n  var searchedProducts = searchProducts || products;\n  var categoryFilteredProducts = filters.categories.length > 0 ? searchedProducts.filter(function (item) {\n    return filters.categories.find(function (categoryId) {\n      var _item$category;\n\n      return categoryId === (item === null || item === void 0 ? void 0 : (_item$category = item.category) === null || _item$category === void 0 ? void 0 : _item$category._id);\n    });\n  }) : searchedProducts;\n  var priceRangeFilteredProducts = filters.priceRanges.length > 0 ? categoryFilteredProducts.filter(function (item) {\n    return filters.priceRanges.filter(function (index) {\n      return PRICE_FILTER_RANGES[index].min <= item.price && PRICE_FILTER_RANGES[index].max >= item.price;\n    }).length > 0;\n  }) : categoryFilteredProducts;\n  var sortedProducts = sortBy ? priceRangeFilteredProducts.sort(function (a, b) {\n    if (sortBy === \"top-rated\") {\n      return true;\n    }\n\n    if (sortBy === \"high-low\") {\n      return b.price - a.price;\n    }\n\n    if (sortBy === \"low-high\") {\n      return a.price - b.price;\n    }\n\n    return true;\n  }) : priceRangeFilteredProducts;\n\n  var onCategoryChange = function onCategoryChange(checked, id) {\n    if (checked) {\n      setSelectedCategories(function (prev) {\n        return [].concat(_toConsumableArray(prev), [id]);\n      });\n    } else {\n      setSelectedCategories(selectedCategories.filter(function (item) {\n        return item !== id;\n      }));\n    }\n  };\n\n  var onPriceRangeChange = function onPriceRangeChange(checked, index) {\n    if (checked) {\n      setPriceRanges(function (prev) {\n        return [].concat(_toConsumableArray(prev), [index]);\n      });\n    } else {\n      setPriceRanges(priceRanges.filter(function (item) {\n        return item !== index;\n      }));\n    }\n  };\n\n  var onApplyClick = function onApplyClick() {\n    setFilters({\n      categories: selectedCategories,\n      priceRanges: priceRanges\n    });\n  };\n\n  var onResetClick = function onResetClick() {\n    setFilters({\n      categories: [],\n      priceRanges: []\n    });\n    setSelectedCategories([]);\n    setPriceRanges([]);\n  };\n\n  useEffect(function () {\n    if (searchText === \"\") {\n      setSearchProducts(null);\n      return;\n    }\n\n    var miniSearch = new MiniSearch({\n      fields: [\"name\", \"price\"],\n      idField: \"_id\"\n    });\n    miniSearch.addAll(products);\n    var searchResults = miniSearch.search(searchText, {\n      fuzzy: 0.2,\n      prefix: true\n    });\n    setSearchProducts(products.filter(function (product) {\n      return searchResults.find(function (searchItem) {\n        return product._id === searchItem.id;\n      });\n    }));\n  }, [searchText]);\n  return /*#__PURE__*/_jsxDEV(Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(Head, {\n      children: [/*#__PURE__*/_jsxDEV(\"title\", {\n        children: \"Products\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 17\n      }, _this), /*#__PURE__*/_jsxDEV(\"link\", {\n        rel: \"icon\",\n        href: \"/favicon.ico\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 17\n      }, _this), /*#__PURE__*/_jsxDEV(\"meta\", {\n        property: \"title\",\n        content: \"Best-priced handicraft products from Nepal | Yala Treasure\"\n      }, \"product_title\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 17\n      }, _this), /*#__PURE__*/_jsxDEV(\"meta\", {\n        property: \"description\",\n        content: \"Yala Treasure - an online shopping platform for Nepali arts and crafts. Buy all kinds of unique, local, and best-priced handicraft products made in Nepal now!\"\n      }, \"product_description\", false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 17\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 13\n    }, _this), /*#__PURE__*/_jsxDEV(Nav, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 13\n    }, _this), /*#__PURE__*/_jsxDEV(\"section\", {\n      className: \"container\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"app-page-container\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"product-grid-container\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"product-filter-container\",\n            children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n              className: \"filter-title\",\n              children: \"Filters\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 123,\n              columnNumber: 29\n            }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"filter-block-list\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"accordion-block\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"accordion-heading\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \"Type\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 127,\n                    columnNumber: 41\n                  }, _this), /*#__PURE__*/_jsxDEV(IconChevronDown, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 128,\n                    columnNumber: 41\n                  }, _this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 126,\n                  columnNumber: 37\n                }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"accordion-content\",\n                  children: categories.map(function (item) {\n                    return /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"list-item\",\n                      children: /*#__PURE__*/_jsxDEV(\"label\", {\n                        className: \"checkbox-wrapper\",\n                        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                          type: \"checkbox\",\n                          className: \"form-control\",\n                          checked: selectedCategories.includes(item._id),\n                          onChange: function onChange(e) {\n                            onCategoryChange(e.target.checked, item._id);\n                          }\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 134,\n                          columnNumber: 53\n                        }, _this), item.name]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 133,\n                        columnNumber: 49\n                      }, _this)\n                    }, item._id, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 132,\n                      columnNumber: 45\n                    }, _this);\n                  })\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 130,\n                  columnNumber: 37\n                }, _this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 125,\n                columnNumber: 33\n              }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"accordion-block\",\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"accordion-heading\",\n                  children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \"Price Range\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 150,\n                    columnNumber: 41\n                  }, _this), /*#__PURE__*/_jsxDEV(IconChevronDown, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 151,\n                    columnNumber: 41\n                  }, _this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 149,\n                  columnNumber: 37\n                }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"accordion-content\",\n                  children: PRICE_FILTER_RANGES.map(function (item, index) {\n                    return /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"list-item\",\n                      children: /*#__PURE__*/_jsxDEV(\"label\", {\n                        className: \"checkbox-wrapper\",\n                        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                          type: \"checkbox\",\n                          className: \"form-control\",\n                          checked: priceRanges.includes(index),\n                          onChange: function onChange(e) {\n                            onPriceRangeChange(e.target.checked, index);\n                          }\n                        }, void 0, false, {\n                          fileName: _jsxFileName,\n                          lineNumber: 157,\n                          columnNumber: 53\n                        }, _this), item.label]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 156,\n                        columnNumber: 49\n                      }, _this)\n                    }, index, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 155,\n                      columnNumber: 45\n                    }, _this);\n                  })\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 153,\n                  columnNumber: 37\n                }, _this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 148,\n                columnNumber: 33\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 124,\n              columnNumber: 29\n            }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"filter-actions\",\n              children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn primary-outline-btn\",\n                onClick: onResetClick,\n                children: \"Reset\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 173,\n                columnNumber: 33\n              }, _this), /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"btn accent-btn\",\n                onClick: onApplyClick,\n                children: \"Apply\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 179,\n                columnNumber: 33\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 172,\n              columnNumber: 29\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 25\n          }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"product-list-container\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"product-list-heading\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"search-container\",\n                children: [/*#__PURE__*/_jsxDEV(IconSearch, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 187,\n                  columnNumber: 37\n                }, _this), /*#__PURE__*/_jsxDEV(\"input\", {\n                  type: \"search\",\n                  className: \"form-control\",\n                  placeholder: \"Search\",\n                  value: searchText,\n                  onChange: function onChange(e) {\n                    setSearchText(e.target.value);\n                  }\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 188,\n                  columnNumber: 37\n                }, _this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 186,\n                columnNumber: 33\n              }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"filter-toggle\",\n                children: /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"btn primary-outline-btn\",\n                  children: \"Filter\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 199,\n                  columnNumber: 37\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 198,\n                columnNumber: 33\n              }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"select-container\",\n                children: /*#__PURE__*/_jsxDEV(\"select\", {\n                  className: \"form-control\",\n                  value: sortBy,\n                  onChange: function onChange(e) {\n                    return setSortBy(e.target.value);\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"option\", {\n                    children: \"Sort By\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 207,\n                    columnNumber: 41\n                  }, _this), /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"top-rated\",\n                    children: \"Top Rated\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 208,\n                    columnNumber: 41\n                  }, _this), /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"high-low\",\n                    children: \"Price: High to Low\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 209,\n                    columnNumber: 41\n                  }, _this), /*#__PURE__*/_jsxDEV(\"option\", {\n                    value: \"low-high\",\n                    children: \"Price: Low to High\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 210,\n                    columnNumber: 41\n                  }, _this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 202,\n                  columnNumber: 37\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 201,\n                columnNumber: 33\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 185,\n              columnNumber: 29\n            }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"product-block\",\n              children: sortedProducts.map(function (item, index) {\n                return /*#__PURE__*/_jsxDEV(Product, {\n                  data: item\n                }, index, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 216,\n                  columnNumber: 37\n                }, _this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 214,\n              columnNumber: 29\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 25\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 21\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 17\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 13\n    }, _this), /*#__PURE__*/_jsxDEV(Footer, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 13\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 108,\n    columnNumber: 9\n  }, _this);\n};\n\n_s(Products, \"OR5gGK7D0fREk8/FRCmMMMEbEGI=\");\n\n_c = Products;\nexport var __N_SSP = true;\nexport default Products;\n\nvar _c;\n\n$RefreshReg$(_c, \"Products\");","map":{"version":3,"sources":["/home/anuz/work/personal/creation-arts/pages/products/index.js"],"names":["React","Fragment","useEffect","useState","Head","Nav","Footer","Product","IconSearch","IconChevronDown","MiniSearch","PRICE_FILTER_RANGES","Products","categories","products","searchText","setSearchText","searchProducts","setSearchProducts","selectedCategories","setSelectedCategories","priceRanges","setPriceRanges","filters","setFilters","sortBy","setSortBy","searchedProducts","categoryFilteredProducts","length","filter","item","find","categoryId","category","_id","priceRangeFilteredProducts","index","min","price","max","sortedProducts","sort","a","b","onCategoryChange","checked","id","prev","onPriceRangeChange","onApplyClick","onResetClick","miniSearch","fields","idField","addAll","searchResults","search","fuzzy","prefix","product","searchItem","map","includes","e","target","name","label","value"],"mappings":"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","sourcesContent":["import React, {Fragment, useEffect, useState} from \"react\";\nimport Head from \"next/head\";\nimport Nav from \"../../components/nav\";\nimport Footer from \"../../components/footer\";\nimport Product from \"../../components/product\";\nimport IconSearch from \"../../components/icons/icon-search\";\nimport IconChevronDown from \"../../components/icons/icon-chevron-down\";\nimport {getCategories, getProducts} from \"../../api\";\nimport MiniSearch from \"minisearch\";\nimport {PRICE_FILTER_RANGES} from \"../../utils/consts\";\nimport {getServerSideCookie} from \"../../utils/serverSideStorage\";\n\nconst Products = ({categories, products}) => {\n    const [searchText, setSearchText] = useState(\"\");\n    const [searchProducts, setSearchProducts] = useState();\n    const [selectedCategories, setSelectedCategories] = useState([]);\n    const [priceRanges, setPriceRanges] = useState([]);\n    const [filters, setFilters] = useState({categories: [], priceRanges: []});\n    const [sortBy, setSortBy] = useState();\n\n    const searchedProducts = searchProducts || products;\n\n    const categoryFilteredProducts =\n        filters.categories.length > 0\n            ? searchedProducts.filter((item) =>\n                filters.categories.find(\n                    (categoryId) => categoryId === item?.category?._id\n                )\n            )\n            : searchedProducts;\n\n    const priceRangeFilteredProducts =\n        filters.priceRanges.length > 0\n            ? categoryFilteredProducts.filter(\n                (item) =>\n                    filters.priceRanges.filter(\n                        (index) =>\n                            PRICE_FILTER_RANGES[index].min <= item.price &&\n                            PRICE_FILTER_RANGES[index].max >= item.price\n                    ).length > 0\n            )\n            : categoryFilteredProducts;\n\n    const sortedProducts = sortBy\n        ? priceRangeFilteredProducts.sort((a, b) => {\n            if (sortBy === \"top-rated\") {\n                return true;\n            }\n            if (sortBy === \"high-low\") {\n                return b.price - a.price;\n            }\n            if (sortBy === \"low-high\") {\n                return a.price - b.price;\n            }\n\n            return true;\n        })\n        : priceRangeFilteredProducts;\n\n    const onCategoryChange = (checked, id) => {\n        if (checked) {\n            setSelectedCategories((prev) => [...prev, id]);\n        } else {\n            setSelectedCategories(selectedCategories.filter((item) => item !== id));\n        }\n    };\n\n    const onPriceRangeChange = (checked, index) => {\n        if (checked) {\n            setPriceRanges((prev) => [...prev, index]);\n        } else {\n            setPriceRanges(priceRanges.filter((item) => item !== index));\n        }\n    };\n\n    const onApplyClick = () => {\n        setFilters({categories: selectedCategories, priceRanges: priceRanges});\n    };\n\n    const onResetClick = () => {\n        setFilters({categories: [], priceRanges: []});\n        setSelectedCategories([]);\n        setPriceRanges([]);\n    };\n\n    useEffect(() => {\n        if (searchText === \"\") {\n            setSearchProducts(null);\n            return;\n        }\n        const miniSearch = new MiniSearch({\n            fields: [\"name\", \"price\"],\n            idField: \"_id\",\n        });\n        miniSearch.addAll(products);\n        const searchResults = miniSearch.search(searchText, {\n            fuzzy: 0.2,\n            prefix: true,\n        });\n        setSearchProducts(\n            products.filter((product) =>\n                searchResults.find((searchItem) => product._id === searchItem.id)\n            )\n        );\n    }, [searchText]);\n\n    return (\n        <Fragment>\n            <Head>\n                <title>Products</title>\n                <link rel=\"icon\" href=\"/favicon.ico\"/>\n                <meta property={\"title\"} content={\"Best-priced handicraft products from Nepal | Yala Treasure\"}\n                      key={\"product_title\"}/>\n                <meta property={\"description\"}\n                      content={\"Yala Treasure - an online shopping platform for Nepali arts and crafts. Buy all kinds of unique, local, and best-priced handicraft products made in Nepal now!\"}\n                      key={\"product_description\"}/>\n            </Head>\n            <Nav/>\n            <section className=\"container\">\n                <div className=\"app-page-container\">\n                    <div className=\"product-grid-container\">\n                        <div className=\"product-filter-container\">\n                            <h3 className=\"filter-title\">Filters</h3>\n                            <div className=\"filter-block-list\">\n                                <div className=\"accordion-block\">\n                                    <div className=\"accordion-heading\">\n                                        <span>Type</span>\n                                        <IconChevronDown/>\n                                    </div>\n                                    <div className=\"accordion-content\">\n                                        {categories.map((item) => (\n                                            <div className=\"list-item\" key={item._id}>\n                                                <label className=\"checkbox-wrapper\">\n                                                    <input\n                                                        type=\"checkbox\"\n                                                        className=\"form-control\"\n                                                        checked={selectedCategories.includes(item._id)}\n                                                        onChange={(e) => {\n                                                            onCategoryChange(e.target.checked, item._id);\n                                                        }}\n                                                    />\n                                                    {item.name}\n                                                </label>\n                                            </div>\n                                        ))}\n                                    </div>\n                                </div>\n                                <div className=\"accordion-block\">\n                                    <div className=\"accordion-heading\">\n                                        <span>Price Range</span>\n                                        <IconChevronDown/>\n                                    </div>\n                                    <div className=\"accordion-content\">\n                                        {PRICE_FILTER_RANGES.map((item, index) => (\n                                            <div className=\"list-item\" key={index}>\n                                                <label className=\"checkbox-wrapper\">\n                                                    <input\n                                                        type=\"checkbox\"\n                                                        className=\"form-control\"\n                                                        checked={priceRanges.includes(index)}\n                                                        onChange={(e) => {\n                                                            onPriceRangeChange(e.target.checked, index);\n                                                        }}\n                                                    />\n                                                    {item.label}\n                                                </label>\n                                            </div>\n                                        ))}\n                                    </div>\n                                </div>\n                            </div>\n                            <div className=\"filter-actions\">\n                                <button\n                                    className=\"btn primary-outline-btn\"\n                                    onClick={onResetClick}\n                                >\n                                    Reset\n                                </button>\n                                <button className=\"btn accent-btn\" onClick={onApplyClick}>\n                                    Apply\n                                </button>\n                            </div>\n                        </div>\n                        <div className=\"product-list-container\">\n                            <div className=\"product-list-heading\">\n                                <div className=\"search-container\">\n                                    <IconSearch/>\n                                    <input\n                                        type=\"search\"\n                                        className={\"form-control\"}\n                                        placeholder={\"Search\"}\n                                        value={searchText}\n                                        onChange={(e) => {\n                                            setSearchText(e.target.value);\n                                        }}\n                                    />\n                                </div>\n                                <div className=\"filter-toggle\">\n                                    <button className=\"btn primary-outline-btn\">Filter</button>\n                                </div>\n                                <div className=\"select-container\">\n                                    <select\n                                        className=\"form-control\"\n                                        value={sortBy}\n                                        onChange={(e) => setSortBy(e.target.value)}\n                                    >\n                                        <option>Sort By</option>\n                                        <option value={\"top-rated\"}>Top Rated</option>\n                                        <option value={\"high-low\"}>Price: High to Low</option>\n                                        <option value={\"low-high\"}>Price: Low to High</option>\n                                    </select>\n                                </div>\n                            </div>\n                            <div className=\"product-block\">\n                                {sortedProducts.map((item, index) => (\n                                    <Product key={index} data={item}/>\n                                ))}\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </section>\n            <Footer/>\n        </Fragment>\n    );\n};\n\nexport default Products;\n\nexport const getServerSideProps = async (context) => {\n    const token = getServerSideCookie(context)(\"token\");\n\n    try {\n        const products = await getProducts(token)();\n        const categories = await getCategories(token)();\n        return {props: {categories, products}};\n    } catch (e) {\n        console.log(\"error\", e.message);\n    }\n    return {props: {categories: [], products: []}};\n};\n\n\n"]},"metadata":{},"sourceType":"module"}